FROM java_base

ARG ALFRESCO_REINDEX_USER_ID
ARG ALFRESCO_REINDEX_GROUP_ID
ARG ALFRESCO_REINDEX_GROUP_NAME
ARG ALFRESCO_REINDEX_USER_NAME

COPY *-app.jar /opt/app.jar
COPY entrypoint.sh /entrypoint.sh

RUN groupadd -g ${ALFRESCO_REINDEX_GROUP_ID} ${ALFRESCO_REINDEX_GROUP_NAME} && \
    useradd -lu ${ALFRESCO_REINDEX_USER_ID} -g ${ALFRESCO_REINDEX_GROUP_NAME} ${ALFRESCO_REINDEX_USER_NAME}

USER ${ALFRESCO_REINDEX_USER_NAME}

ENTRYPOINT ["/entrypoint.sh"]
